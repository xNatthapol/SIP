<link href="https://fonts.cdnfonts.com/css/riesling" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Barlow+Semi+Condensed:ital,wght@0,100;0,200;0,300;0,400;1,100;1,200&family=Italianno&display=swap" rel="stylesheet">


{% extends "sip/base.html" %}

{% block content %}
<style>
    body {
        background-color: #002C1D;
        /* background-color: aqua; */
        /* position: static; */
        /* overflow-x: scroll; */
        overflow-x: hidden;
    }

    /* @media all and (max-width: 1350px) {
        img {
            display: none;
        }
    } */

    .text {
        font-family: 'Barlow Semi Condensed', sans-serif;
        color: black;
    }

    .text-ingre {
        /* display: grid; */
        float: right;
        margin-top: 30px;
        /* margin-right: 250px; */
        max-width: 450px;
    }

    .ingree {
        width: 450px;
        margin-top: 15px;
        padding-bottom: 45px;
        padding-top: 20px;
        border-bottom: #ffffff solid 2px;
        border-top: #ffffff solid 2px;
    }

    #ingr-text {
        color: #ffffff;
        float: right;
        font-size: 25px;
        margin-right: 10px;
    }

    .small-ingree {
        background-color: #F5F5DC;
        display: inline-flex;
        border-radius: 5px;
        width: 450px;
        max-width: 450px;
        height: 300px;
        max-height: 300px;
        padding: 15px;
        overflow-y: scroll;
    }

    #ingr-names, #ingr-measure {
        list-style: none;
    }

    #ingr-names {
        margin-left: 15px;
        height: 100%;
        width: 100%;
        overflow-y: scroll;
        overflow-x: scroll;
    }

    #ingr-measure {
        padding-left: 15px;
        border-left: black solid 2px;
        border-radius: 2px;
        width: 43%;
        overflow-x: scroll;
        overflow-y: scroll;
    }

    #cock-text {
        font-family: 'Italianno', cursive;
        color: #FCDF76;
        font-size: 55px;
        font-weight: 400;
        word-wrap: break-word;
        /* margin-right: 25px; */
        margin-bottom: 30px;
        text-align: center;
    }

    .img-intr {
        max-width: 450px;
        margin-top: 30px;
        text-align: center;
    }

    .intrr {
        display: inline-table;
        margin-top: 30px;
        border-top: white solid 2px;
        width: 450px;
        height: 200px;
        max-width: 450px;
        max-height: 200px;
        padding-bottom: 40px;
        border-bottom: white solid 2px;
    }

    #intr-text {
        color: #ffffff;
        font-size: 25px;
        margin-left: 10px;
        margin-top: 15px;
        float: left;
    }

    #intr {
        background-color: #F5F5DC;
        border-radius: 5px;
        width: 450px;
        height: 200px;
        max-width: 450px;
        max-height: 200px;
        padding: 15px;
        overflow-y: scroll;
        text-align: left;
    }

    .star-rating {
        font-family: 'Barlow Semi Condensed', sans-serif;
        color: white;
        background-color:#282828;
        display: inline-flex;
        /* padding-left: 6px; */
        border-radius: 5px;
        height: 40px;
        padding-left: 7px;
        padding-right: 7px;
    }

    .star {
        color: #FCDF76;
        font-size: 24px; /* Adjust the size as needed */
        display: inline-block;
        margin-right: 3px;
    }

    .star.half {
        background: linear-gradient(90deg, #FCDF76 50%, transparent 50%);  /* Half green background */
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
    }

    /* .star.half, .star {
        margin-top: 10px;
    } */

    img {
        max-width: 450px;
        max-height: 270px;
        /* width: auto;
        height: auto; */
        border-radius: 50%;
        object-fit: cover;
        margin-left: 50%;
        transform: translateX(-50%);
    }

    .reviews {
        margin-top: 55px;
        width: 69vw;
        max-width: 69vw;
        min-width: 50vw;
        display: inline-table;
        margin-bottom: 50px;
        overflow-y: scroll;
        margin-left: 50%;
        transform: translateX(-50%);
    }

    #comm {
        color: #ffffff;
        font-size: 25px;
        margin-left: 10px;
        margin-top: -40px;
        float: right;
        margin-right: 10px;
    }

    .rev-block {
        background-color: #F5F5DC;
        border-radius: 5px;
        width: 69vw;
        height: 200px;
        /* max-width: 450px; */
        /* max-height: 200px; */
        padding: 15px;
    }

    .send-butt {
        font-family: 'Barlow Semi Condensed', sans-serif;
        box-shadow: rgba(0, 0, 0, 0.12) 0px 1px 3px, rgba(0, 0, 0, 0.24) 0px 1px 2px;
        background-color: #36454F;
        /* padding: 10px; */
        text-decoration: none;
        /* top: 30px; */
        color: white;
        border-radius: 5px;
        margin-right: 15px;
        border: none;
    }

    .form-group {
        display: inline-flex;
        height: fit-content;
    }

    #avg-scr {
        font-size: 17px;
        color: #ffffff;
        margin-left: 10px;
        margin-top: 6px;
    }

    textarea {
        max-height: 30px;
        min-height: 30px;
        width: fit-content;
        min-width: 300px;
        overflow-x: scroll;
        scroll-behavior: smooth;
        width: 50vw;
    }

    #senddd {
        position: relative;
        top: -9px;
    }

    .big-block {
        /* background-color: aqua; */
        display: inline-block;
        width: 70vw;
        min-width: 900px;
        margin-left: 50%;
        transform: translateX(-50%);
    }

    .comments {
        line-height: 2px;
        padding: 5px;
        padding-bottom: 0;
        overflow: scroll;
        /* overflow-x: scroll; */
        overflow-y: scroll;
        overflow-wrap: break-word;
        height: 100px;
    }

    #commento {
        background-color: #282828;
        padding: 5px;
        line-height: 20px;
        border-radius: 5px;
        color: white;
        display: block;
    }

    .star-container {
        text-align: center;
    }

    #rev-user {
        color: #FCDF76;
    }

    #rev-mess {
        color: white;
        max-width: fit-content;
        overflow: hidden;
        overflow-wrap: break-word;
    }

</style>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ cocktail.name }} Detail</title>
</head>
<body>
    <div class="big-block">
        <!-- Text and ingredients block -->
        <div class="text-ingre" id="small-block">
            <h1 class="text" id="cock-text">{{ cocktail.name }}</h1>

            <!-- Star Rating -->
            <div class="star-container">
                {% if star_rating %}
                    <div class="star-rating">
                        {% for _ in star_rating.0|default:0 %}
                            <span class="star">&#9733;</span>
                        {% endfor %}
                        {% if star_rating.1 %}
                            <span class="star half">&#9733;</span>
                        {% endif %}
                        <p class="text" id="avg-scr">{{ average_score }} / 5</p>
                    </div>
                {% else %}
                    <p class="star-rating">No ratings yet</p>
                {% endif %}
            </div>

            <div class="ingree">
                <h2 class="text" id="ingr-text">Ingredients</h2>
                <div class="small-ingree">
                    <div class="text" id="ingr-names">
                        {% for ingredient in cocktail.cocktailingredient_set.all %}
                            <li class="text" id="name">
                                <a class="text" href="{% url 'SIP:ingredient_detail' ingredient.ingredient.id %}">
                                    {{ ingredient.ingredient.name }}
                                </a>
                            </li>
                        {% endfor %}
                    </div>
                    <div class="text" id="ingr-measure">
                        {% for ingredient in cocktail.cocktailingredient_set.all %}
                            <!-- <li class="text" id="measure">{{ ingredient.measure }}</li> -->
                            {% if ingredient.measure %}
                                <li class="text" id="measure">{{ ingredient.measure }}</li>
                            {% else %}
                                <li class="text" id="measure">Varies</li>
                            {% endif %}
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>

    <!-- Image and instructions block -->
    <div class="img-intr" id="small-block">
        {% if cocktail.image %}
          <img src="{{ cocktail.image }}" alt="{{ cocktail.name }}">
        {% elif cocktail.user_uploaded_image %}
          <img src="{{ cocktail.user_uploaded_image.url }}" alt="{{ cocktail.name }}">
        {% endif %}
        <form method="post" action="{% url 'SIP:add_to_favourites' 'cocktail' cocktail.pk %}">
            {% csrf_token %}
            <button type="submit">Add to Favourites</button>
        </form>

            <div class="intrr">
                <h2 class="text" id="intr-text">Instructions</h2>
                <p class="text" id="intr">{{ cocktail.instructions }}</p>
            </div>
        </div>
    </div>

    <!-- Reviews block -->
    <div class="reviews">
        <h2 class="text" id="comm">Comments</h2>
        <div class="rev-block">
            
            <div class="form-group">
                <!-- Comment Form -->
                <form class="comm-form" method="post" action="{% url 'SIP:add_review' pk=cocktail.pk %}">
                    {% csrf_token %}
                    <textarea name="{{ comment_form.message.html_name }}" maxlength="255"> </textarea>

                    <button id="senddd" class="send-butt" type="submit">Send</button>
                </form>

                <!-- Star Form -->
                <form method="post" action="{% url 'SIP:add_star' pk=cocktail.pk %}">
                    {% csrf_token %}
                    <input type="number" min="1" max="5" id="{{ star_form.score.id_for_label }}" name="{{ star_form.score.html_name }}">
                    <label for="{{ star_form.score.id_for_label }}"></label>
                    <button class="send-butt" type="submit">Add Star</button>
                </form>
            </div>

            <!-- Comments -->
            <div class="comments">
                {% if reviews %}
                    {% for review in reviews %}
                        <div class="text" id="commento">
                            <p id="rev-user">{{ review.user }} :</p> <p id="rev-mess">{{ review.message }}</p>
                        </div>
                        <br>
                    {% endfor %}
                {% else %}
                    <p class="text">No reviews yet.</p>
                {% endif %}
            </div>
        </div>
    </div>


    {% if clean_error %}
        <div class="error">
            <p>{{ clean_error }}</p>
        </div>
    {% endif %}


    {% if comment_form.errors %}
        <div class="error">
            <p>Please correct the errors below:</p>
            {{ form.errors }}
        </div>
    {% endif %}

    {% if star_form.errors %}
        <div class="error">
            <p>Please correct the errors below:</p>
            {{ form.errors }}
        </div>
    {% endif %}


</body>
</html>

{% endblock %}
